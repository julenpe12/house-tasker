{% extends "base.html" %}

{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/task_list.css' %}">
{% endblock %}

{% block main %}
<h2>Lista de Tareas</h2>

<div class="task-container">
  {% for task in tasks %}
    <div class="task-item {% if task.is_overlapping %}task-overlapping{% else %}task-ok{% endif %}">
      <a href="{% url 'task_detail' task.id %}">{{ task.title }}</a>
      <span class="priority">Prioridad: {{ task.get_priority_display }}</span>
      {% if task.is_overlapping %}
        <span class="status">En conflicto</span>
      {% else %}
        <span class="status">Normal</span>
      {% endif %}
      <div class="task-dates">
        <span class="start-date">Inicio: {{ task.start_date|date:"d/m/Y H:i" }}</span>
        <span class="duration">Duraci√≥n: {{ task.duration }}</span>
        <span class="end-date">Fin: {{ task.end_date|date:"d/m/Y H:i" }}</span>
      </div>
      <div class="task-resources">
        <strong>Recursos:</strong>
        {% if task.resources.all %}
          <ul>
            {% for resource in task.resources.all %}
              <li>{{ resource.name }} ({{ resource.quantity }} disponibles)</li>
            {% endfor %}
          </ul>
        {% else %}
          <p>No se asignaron recursos a esta tarea.</p>
        {% endif %}
      </div>
    </div>
  {% empty %}
    <p>No se encontraron tareas.</p>
  {% endfor %}
</div>

<div class="add-task-button-container">
  <a href="{% url 'task_create' %}" class="add-task-button">Agregar Tarea</a>
</div>
{% endblock %}